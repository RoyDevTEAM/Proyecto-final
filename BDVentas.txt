create database BDVentas
use BDVentas

create table rol (
    id_rol int not null identity primary key,
    rol varchar(256) not null
);

create table categoria (
    id_categoria int not null identity primary key,
    nombre_categoria varchar(256) not null,
    descripcion varchar(256) not null
);

create table subcategoria (
    id_subcategoria int not null identity primary key,
    id_categoria int not null references categoria (id_categoria),
    nombre_subcategoria varchar(256) not null,
    descripcion varchar(256) not null
);

create table unidad_medida (
    id_unidad_medida int not null identity primary key,
    nombre_medida varchar(256) not null,
	abreviatura varchar(256) not null
);

create table descuento (
    id_descuento int not null identity primary key,
    descuento_unidad decimal not null,
    descuento_porcentaje decimal not null
);

create table proveedor (
    id_proveedor int not null identity primary key,
    nombre_proveedor varchar(256) not null,
    contacto_proveedor varchar(256) not null,
    direccion_proveedor varchar(256) not null,
    telefono_proveedor varchar(256) not null,
    nit_proveedor varchar(256) not null,
    email_proveedor varchar(256) not null
);

create table usuario (
    id_usuario int not null identity primary key,
    id_rol int not null references rol (id_rol),
    nombre_usuario varchar(256) not null,
    apellido_usuario varchar(256) not null,
    numero_carnet varchar(256) not null,
    telefono varchar(256) not null,
    direccion varchar(256) not null,
    usuario varchar(256) not null,
    contrasena varchar(256) not null
);

create table cliente (
    id_cliente int not null identity primary key,
    nombre_cliente varchar(256) not null,
    apellido_cliente varchar(256) not null,
    numero_carnet varchar(256) not null,
    telefono varchar(256) not null,
    direccion varchar(256) not null
);

create table producto (
    id_producto int not null identity primary key,
    id_unidad_medida int not null references unidad_medida (id_unidad_medida),
    id_subcategoria int not null references subcategoria (id_subcategoria),
    nombre_producto varchar(256) not null,
    precio_producto varchar(256) not null,
    descripcion_producto varchar(256) not null,
    stock int not null
);

create table compra (
    id_compra int not null identity primary key,
    fecha_compra date not null,
    precio_compra decimal not null,
    descripcion_compra varchar(256),
	total_compra decimal not null,
    id_proveedor int not null references proveedor (id_proveedor),
    id_usuario int not null references usuario (id_usuario)
);

create table detalle_compra (
    id_detalle_compra int not null identity primary key,
    id_producto int not null references producto (id_producto),
    id_compra int not null references compra (id_compra),
    cantidad_detalle_compra int not null,
    precio_compra decimal not null,
    fecha_vencimiento_producto date,
	subtotal_compra decimal not null
);

create table pago_credito (
    id_pago_credito int not null identity primary key,
    fecha_pago date not null,
    monto_pagado decimal not null,
    saldo_pendiente decimal not null
);

create table venta (
    id_venta int not null identity primary key,
    id_descuento int not null references descuento (id_descuento),
    id_cliente int not null references cliente (id_cliente),
    id_usuario int not null references usuario (id_usuario),
    fecha_venta date not null,
    tipo_pago varchar(256) not null,
    total_venta decimal not null
);

create table detalle_credito (
    id_detalle_credito int not null identity primary key,
    id_venta int not null references venta (id_venta),
    id_pago_credito int not null references pago_credito (id_pago_credito)
);

create table detalle_venta (
    id_detalle_venta int not null identity primary key,
    id_venta int not null references venta (id_venta),
    id_producto int not null references producto (id_producto),
    cantidad int not null,
    subtotal decimal not null
);